# フロントエンドアーキテクチャ拡張

既存の `skill-quest-ai` フロントエンドをベースにしつつ、CrewAI依存部分を排除し、Hono RPCとの接続を行う。

## ステート管理 (TanStack Query)

サーバー状態（クエスト一覧、ユーザープロファイル）の管理には、**TanStack Query (React Query)** を採用する。これにより、キャッシュ、自動リフェッチ、ローディング状態の管理が容易になる。

Hono Clientと組み合わせることで、以下のような型安全なデータフェッチが可能になる。

```typescript
// hooks/useQuests.ts
import { useQuery } from '@tanstack/react-query'
import { client } from '@/lib/client'

export const useQuests = () => {
  return useQuery({
    queryKey: ['quests'],
    queryFn: async () => {
      const res = await client.api.quests.$get()
      if (!res.ok) throw new Error('Failed to fetch')
      return await res.json() // ここで型推論が効く
    }
  })
}
```

## AIチャットUIの実装

AIからのストリーミングレスポンスを表示するため、カスタムフック `useChat` を実装する。Vercel AI SDKの `useChat` フックを利用することも可能だが、Cloudflare Workers AIのストリーム形式に合わせるため、軽量な独自実装または `ai` パッケージの `StreamingTextResponse` 対応アダプタの利用を検討する。

## 認証UI

Better AuthはReact用クライアントライブラリを提供している。`apps/frontend/src/lib/auth-client.ts` を作成し、ログイン、ログアウト、セッション取得のメソッドをコンポーネントから利用する。
